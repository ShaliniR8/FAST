namespace :root_causes do

  task :add_root_causes => :environment do

primary = "Airport Operations





Aircraft Damage







Aircraft Operation





























Altitude Deviation






Airline Operation Complications











Cabin Operations

















Catering












General Operations/Facilities




Employee Event







Crew Scheduling/Planning





Customer Service/Disatified Passenger














Dispatch Operations








iPad Concerns







Employee Communication















Equipment Malfunction










































































































































































































































Fatigue Event








Go-Around/Missed Approach









Maintenance Operations
















Navigation Deviation





Illness/Injury 























Passenger Misconduct


















Rejected Takeoff








Airport Operations





Speed Deviation





Security





Station Operations
















































Taxi Event






TCAS RA







Weather Event











Weight and Balance












Turbulence






Wildlife Strike"

sub = "Airport/Ramp Construction
Airport Communications Issues
Ramp Conditions
Snow/Ice Removal
Other

GSE Struck Aircraft
Engine Ingestion Event
GPU Damage
Jetway Contacted Aircraft
Slide Deployment
Tail Strike
Other

Anti-ice Configuration
Aircraft Cleaning
Aircraft Limitation Exceeded
Aircraft Performance 
APU Operation
ATC Communications
Autoland/LLM Operations
Diversion
Failure to Follow Operating Rule (FAR)
Failure to Follow SOP
Fuel Management
GPWS Warning
Hard Landing
Improper Engine Start/ITT Limit Exceeded
Improper Pilot Technique
Landed on Wrong Runway
Landed With Incorrect Flap Setting
Landed Without A Clearance
Laser Beam Exposure
Medlink Communication
Operated Outside Curfew
Runway Lighting
Runway Overrun
Smoke/Fire Warning
Stall Warning
Takeoff With Incorrect Flap Setting
Wake Turbulence Event
Wheel Fire Warning
Other

FMS Programming Error
Incorrect Altimeter Setting
Level Off Bust
Similar Callsigns
Unclear ATC Instructions
Other

Inaccurate/Confusing NOTAMS or Logbook Entry
Airport Advisory Pages (AAI)
Briefing Cards
Charter Summaries
Crew Member not Using Current Revision
Delay for Manuals
Inaccurate/Confusing MEL Procedures
Inaccurate/Confusing Procedure/SOP
Policy/Procedure Implementation
Training Development/Solutions/Suggestions
Other

Infant-in-Lap Policy
Aircraft Temperature
Delegation of Duties
Emotional Support Animal
Extended Ground Delay/Supplies Used 
Failure to Follow SOP
Hazmat
Minimum Crew
Passenger Count Discrepancy
Pet In Cabin
Post Flight Checks Not Completed
Preflight Checks Not Completed
Seating Issues
Service Animal
Service Cart Unsecured
Smoke/Fire/Fumes
Other

Crew Meals
Charter Operations
Equipment Condition
Failure to Follow SOP
Food Quality/Temp
Galley Cart Allocation
Galley Cart/Oven Condition
Galley Loading Procedures
Handheld Device
Inadequate/Missing Supplies 
International Trash
Other

Vehicle Accident
Facilities Concern
Hotel/Transportation (Non-Crew Scheduling)
Other

Badging Issues
Forgot/Lost Employee Badge
Forgot/Lost Flight Attendant EFB or Charging Cord 
Forgot/Lost Passport
Pilot Certificate Missing
Possible Intoxication
Other

Assignment of Duty Periods
Crew Notification
Hotel Issue
Transportation Issues
Other

Catering
Carry On Baggage Policy
Childseat
Delay 
Exit Row Seating
Ground Service
Inflight Service
Language Barrier
Part 382 Requirements
Passenger of Size
Passenger/Baggage Handling on Charter
Passenger/Baggage Handling on Scheduled
Premium Seat Upgrade
Other

Alternate Requirements
Flight Planning
Flight Release Inaccuracy
MEL Not Added to Release/Issues
NOTAM Accuracy
Overwater Equipment Requirement
Release Amendment
Other

Broken/Missing iPad
Broken iPad Mount
iPad Not Charged
Missing or Out of Date Manuals/Apps
Network Connectivity
Software Issues
Other

Between Pilots and ATC
Between Pilots and Cabin/Flight Attendant(s)
Between Pilots and SOC/SSD
Between Pilots and Dispatch
Between Pilots and Maintenance/Maintenance Control
Between Pilots and Station Operations
Between Pilots and Pilots
Between Cabin/Flight Attendant(s) and Station Operations
Between Cabin/Flight Attendant(s) and Cabin/Flight Attendant(s)
Between Dispatch and SOC/SSD
Between Dispatch and Dispatch
Between Maintenance/Maintenance Control and Station Operations
Between Maintenance/Maintenance Control and Maintenance/Maintenance Control
Between Station Operations and Station Operations
Other

05 - Time Limits/MX Checks
07 - Lifting and Shoring
08 - Leveling and Weighing
09 - Towing and Taxiing
10 - Parking and Mooring
11 - Placards and Markings
12 - Servicing
20 - Standard Practices
21 - Air Conditioning/Pressurization
22 - Autoflight
23 - Communications
24 - Electrical Power
25 - Equipment/Furnishings
26 - Fire Protection
27 - Flight Controls
28 - Fuel
29 - Hydraulics
30 - Ice and Rain
31 - Indicating/Recording Systems
32 - Landing Gear
33 - Lights
34 - Navigation
35 - Oxygen
36 - Pneumatics
38 - Water Waste
44 - Cabin Systems
46 - Inforamtion Systems
47 - Inert Gas Systems
49 - APU
51 - Structures
52 - Doors
53 - Fuselage
54 - Nacelles/Pylons
55 - Stabilizers
6 - Windows
57 - Wings
72 - Engine
73 - Engine Fuel and Control
74 - Ignition
75 - Engine Air
76 - Engine Controls
77 - Engine Indicating
78 - Thrust Reverser/Exhaust
79 - Oil
80 - Starting
Other Equipment Malfunction

Hotel Issues
Difficulties Adjusting Sleep Patterns to Schedule
Duty/Flight Time Limits Exceeded
Operational Delays/Long Duty Day
Red Eye Flight Scheduling
Scheduling of Crew Members
Transportation Issues
Other

Aircraft on Runway
ATC Instructed - Aircraft Spacing
ATC Instructed - Other
Configuration Warning/Incorrect Configuration
Unstable Approach
Vehicle on Runway
Visibility
Windshear/Turbulence/Other
Other

CAT II Downgrade/Upgrade
CVR/FDR Procedures
Engine Run Event
Engine Wash
Improper Clearing/Documentation of MEL
Improper Logbook Documentation
Incorrect Part Installed
Missing Logbook
MX COMAT
Possible Maintenance Error
Required inspection I Issues
Tool Left on Aircraft
Towing/Taxi Event 
Undocumented Aircraft Damage
Undocumented Maintenance Performed
Other

Confusing ATC Instructions
FMS Programming Error
Misread SID/STAR/Routing
On Approach
Other

Anxiety
AED Used
Bump/Bruise/Laceration
Burn
Denied Boarding
Difficulties Breathing
Exposure Incident (BBP/needles)
Fainting
Hit by Cart
Medical Emergency
Nausea
Oxygen Used
Possible Allergic Reaction
Possible Communicable Disease
Possible Diabetic Reaction
Possible Heart Attack
Possible Stroke
Prior to Boarding/ Departure
Seizure
Slip/Fall Event
Turbulence-Related
Unresponsive Passenger
Other

Carry On Baggage Policy
Brought Aboard Own Alcohol
Denied Boarding
Disruptive Child
Disruptive Passenger
Electronic Device
Intoxicated Passenger
Non-Compliant Passenger
Non-Revenue Passenger
Passenger in Lav during Taxiing/Landing
Passenger/Employee Conflict
Physical Assualt
Seat Belt Sign
Seating Issues
Smoking on Aircraft/Lav
Suspicious Behavior
Unaccompanied Minor
Other

ATC Instructed
Config Warning
Crew Member Induced
Master Caution/Warning
System Failure
TLA not TOGA
Window Open
Other

Airport/Ramp Construction
Airport Communications Issues
Ramp Conditions
Snow/Ice Removal
Other

ATC Clearance Exceeded
Flap Limit Exceeded
Published Speed Exceeded
Vmo/Mmo Exceeded
Other

Passenger Security Event
Aircraft Security Search
Military Security
Security Seals on Aircraft Doors/Carts
Other

Agent Availability
APU Operation
Audit (from Outside Agency)
Baggage/Cargo Misload
Boarding/Deplaning Process
Broken Towbar/Shear Pin
Cargo Net not Properly Secured
Cargo Operations
Carry On Baggage 
Child Restraint Seat (CRS)
Chocking Aircraft
Cleaning
Dangerous Goods
De-Icing
Door/Panel Opening/Closing Procedures
Emotional Support Animal
Equipment Condition
Exit Row Seating
Failure to Follow SOP
FOD
Fueling Procedures
Ground Power/Air Conditioning
Hazardous Weather Procedures
Hazmat
Illegal Substance
Inadequate Communications
Inadequate Staffing
Incomplete/Missing Cargo Manifest
Jet Bridge/Passenger Boarding Ramp/Air Stairs
Lap Child- New May 2018
Load Above Fire Line
Non Standard Pushback Phraseology
Off Terminal Operations (FBO/Building C, etc)
Overbooking of Flight
Part 382 Requirements
Pet In Cabin
Portable Oxygen Concentrator (POC)
Potable Water
Pushback/Taxi In Event
Seat Map Changed
Service Animal
Start Cart/Huffer Cart
TSA Prohibited Item
Unable to Contact Station Operations
Unaccompanied Minor
Water Safety Event
Wheelchair Assistance
Other

Confusing Taxi Instructions
Marshalling at Building B/C Ramp
Runway Incursion
Taxied on Incorrect Taxiway
Taxiway Incursion
Other

Aircraft on Parallel Approach
ATC Induced
Departure
In Class A Airspace
VFR Aircraft - Near Approach/Arrival Path
VFR Aircraft - Near Departure Path
Other

Diversion Due to Approach Below Minimums/Visibility
Diversion Due to Braking Action
Diversion Due to Snow Event
Diversion Due to Thunderstorm Activity
Diversion Due to Winds/Turbulence
Flew Into Thunderstorm
Ground Stop
Hail
Lightning Strike
Windshear Encounter
Other

AeroData
Cargo Nets
Gaps between Aircraft and Jet Bridge/Air Stairs
Incorrect Loading
Paperwork Error - CLR (Bags)
Paperwork Error - CLR (Cargo/Mail)
Paperwork Error - CLR (COMAT)
Paperwork Error - PLR
Passenger Deplane
Passenger Seating/Re-Seating
Standard Weights
Other

Unknown
Clear Air
Mountain Wave
Thunderstorm/Severe Weather
Wake Turbulence
Other

Bird Strike away from airport
Bird Strike on Approach
Bird Strike on Rotation
Wildlife Strike/Encounter
Other"

nested = "10 - Maintenance Checks
20 - Conditional Inspections
30 - Other

10 - Jacking
20 - Shoring

10 - Weighing

10 - Towing
20 - Taxiing

10 - High Wind Condition Parking/Mooring

10 - Exterior Placards
20 - Interior Ploacards

10 - Fuel Servicing
20 - Hydraulic Servicing
30 - Oil Servicing
40 - Potable Water Servicing
50 - Waste Servicing
60 - Cold Weather Maintenance
70 - Aircraft Cleaning

10 - Temp Hydraulic Lines
20 - Other

10 - Distribution
20 - Equipment Cooling
30 - Pressurization
40 - Pack Cooling System
50 - Other

10 - Autoflight
20 - Yaw Damper
30 - Autothrottle

10 - VHF
20 - HF
30 - ACARS
40 - SATCOM
50 - Passenger Address
60 - Interphone
70 - Other

10 - AC Power
20 - DC Power
30 - Batery Power
40 - In Seat Power Supply
50 - Other

10 - Flight Deck
20 - Cabin 
30 - Seats
40 - Emergency Equipment
50 - Other

10 - Engine
20 - APU
30 - Lavatories
40 - Cargo
50 - Other

10 - Aileron
20 - Rudder
30 - Elevator
40 - Horizontal Stabilizer
50 - Flaps
60 - Slats
70 - Spoilers 
80 - Stall Warning
90 - Other

10 - Fuel Tanks 
20 - Distribution
30 - Engine Fuel Feed
40 - APU Fuel Feed
50 - Fuel Indication
60 - Other

10 - System A
20 - System B
30 - Standby System
40 - Other

10 - Wing Thermal Anti-Ice
20 - Engine Anti-Ice
30 - Air Data Sensor Anti-Icing
40 - Windshield Anti-Icing
50 - Other

10 - Clocks
20 - FDR
30 - Aural Warning Systems
40 - Common Display Systems
50 - Other

10 - Air/Ground Systems
20 - Main Landing Gear
30 - Nose Landing Gear
40 - Landing Gear Control
50 - Brakes 
60 - Wheels/Tires
70 - Nose Wheel Steering
80 - Position Indicating 
90 - Other

10 - Interior Lights 
20 - Exterior Lights 
30 - Emergency Lights 
40 - Other

10 - Air Data Instruments
15 - Standby Air Data Instrument
20 - ILS
25 - Radio Altimeter
30 - Weather Radar 
35 - TCAS
40 - GPWS
45 - VOR 
50 - ATC
55 - DME
60 - ADF
65 - GPS
70 - FMC
75 - Other

10 - Crew Oxygen
20 - Passenger Oxygen 
30 - Portable Oxygen

10 - Engine Bleed System 
20 - APU Bleed System 
30 - Distribution 
40 - Indication 
50 - Other

10 - Potable Water System 
20 - Waste System
30 - Other

10 - AirFi System 

10 - Other

10 - Inert Gas System Control System 
20 - Other

10 - APU Control 
20 - APU Engine 
30 - APU Indication 
40 - APU Oil 
50 - Other

10 - Missing Fasteners
20 - Other

10 - Cabin Doors
20 - Cargo Doors
30 - Flight Deck Door
40 - Other

10 - Fuselage Damage
20 - Wheel Wells
30 - Cabin Floors
40 - Radome 
50 - Tail Cone
60 - Fairings
70 - Other

10 - Strut
20 - Strut Fairings
30 - Strut Panels 
40 - Other

10 - Horizontal Stabilizer (Structure)
20 - Vertical Stabilizer (Structure)
30 - Other

10 - Flight Deck Windows 
20 - Cabin Windows 
30 - Other

10 - Wing Structure
20 - Wing Panels
30 - Winglet 
40 - Wing Leading Edge
50 - Wing Trailing Edge 
60 - Other

10 - Air Inlet 
20 - Fan Blades 
30 - Engine Drains
40 - Engine Cowlings
50 - Engine Vibration 
60 - Other 

10 - Engine Fuel Distribution 
20 - Fuel Control System 
30 - Fuel Flow Indicating System 
40 - Other 

10 - Ignition Exciter
20 - High Tension Distribution 
30 - Other 

10 - Bleed Control 
20 - Other

10 - Thrust Levers 
20 - Start Levers 
30 - Other

10 - Engine Tachometer System 
20 - EGT Indication System 
30 - Engine Vibratio Monitoring 
40 - Other

10 - Thrust Reverser System 
20 - Exhaust System 
30 - Other 

10 - Oil Distribution 
20 - Oil Quantity
30 - Oil Pressure 
40 - Oil Temperature 
50 - Other 

10 - Engine Starter
20 - Start Control Valve 
30 - Other"

    minor_sub = []
    root = CauseOption.find(260)
    parent_option = CauseOption.find(260)
    primary = primary.split("\n").reject(&:empty?)
    sub = sub.split("\n\n")
    sub_index = 0
    nested_index = 0
    nested = nested.split("\n\n")
    level = 0
    CauseOption.transaction do 
      primary.each do |primary_item|
        level = 1
        parent_option = CauseOption.create(:name => primary_item, :level => level)
        root.cause_options << parent_option
        parent_option.cause_options << root
        puts ">Category #{primary_item}"
        sub[sub_index].split("\n").each do |item|
          level = 2
          sub_option = CauseOption.create(:name => item, :level => level)
          parent_option.cause_options << sub_option
          sub_option.cause_options << parent_option        
          puts ">>Sub item #{item}"
          # skip sub categories without nested categories
          if primary_item == "Equipment Malfunction" && item != "Other Equipment Malfunction"       
            level = 3
            nested[nested_index].split("\n").each do |nested_item|
              nested_option = CauseOption.create(:name => nested_item, :level => level)
              sub_option.cause_options << nested_option
              nested_option.cause_options << sub_option
              puts ">>>Nested item #{nested_item}"
            end
            nested_index += 1
          end
        end
        sub_index += 1
      end
    end
  end
end





