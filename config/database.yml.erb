default: &default
  adapter: mysql2
  encoding: utf8
  username: devuser
  password: jaguar1995
  host: localhost
  timeout: 5000

<%
  databases = {
    'top'      => { env: '',          mod: '' },
    'audit'    => { env: 'audit_',    mod: 'audit' }
  }

  environments = {
    'production'   => { tag: 'live',      env: 'production'  },
    'development'  => { tag: 'dev',       env: 'development' },
    'training'     => { tag: 'training',  env: 'training'    }

  }

  active_environments = (['production','development'] + SYSTEM_ENVIRONMENTS)
                        .map { |env| environments[env] }
                        .compact
  active_databases = (['top'] + ENABLED_SYSTEMS)
                      .map { |mod| databases[mod] }
                      .compact
%>
<% active_environments.each do |environment| %>
<% active_databases.each do |database| %>
<%= "#{database[:env]}#{environment[:env]}:" %>
  <<: *default
  database: <%= "prosafet#{database[:mod]}_#{underscore(@airline_code)}_#{environment[:tag]}_db" %>
<% end %>
<% end %>
