<%#=form_tag sras_srm_meeting_path(@meeting),:method=>"post" do%>
<div class="panel-warning">
  <div class="panel-heading">
    <div class="panel-title">
      Add SRAs
      <button type="button" class="close pull-right" data-dismiss="modal" aria-label="Close">
        <span class="glyphicon glyphicon-remove"></span>
      </button>
    </div>
  </div>
  <div class="panel-body" style="max-height:500px;overflow-y:auto;" >
    <table class="table table-striped table-bordered table-hover" id="add_sras_table">
      <thead>
        <tr>
          <%@sra_headers.each do |h|%>
            <th><%=h[:title]%></th>
          <%end%>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
            <%@sras.each do |p|%>
              <tr pid="<%=p.id%>">
                <%@sra_headers.each do |h|%>
                  <td class="<%=h[:html_class].present? ? p.send(h[:html_class]) : ''%>" >
                    <%=render '/forms/show_field', :field_hash => h, :record => p%>
                  </td>
                <%end%>
                <td>
                  <%#=check_box_tag "sras[]", p.id, false, :class => "add_sra"%>
                  <%=link_to "Add", "#",
                    :class => "btn btn-sm btn-success add_sra_btn mb5",
                    :disable_with => "Adding..."%>
                    <%=link_to "View SRA",
                    sra_path(p),
                    target: :_blank,
                    'hover' => 'tooltip',
                    title: 'View Sra',
                    :class => "btn btn-sm btn-info mb5"%>
                </td>
              </tr>
            <%end%>
          </tbody>
        </table>
      <%#=submit_tag "Submit", :class => "btn btn-success pull-right", :disable_with => "Submitting..."%>
  </div>
</div>
<%#end%>


<script>
  $(document).ready(function(){
    var dt = $("#sras_table").DataTable();

    $("#add_sras_table").on('click', '.add_sra_btn', function(){
        var tr = $(this).closest('tr')
        $.get("/sras/"+$(this).closest('tr').attr('pid')+"/add_meeting?meeting=<%=@meeting.id%>", function(data){
          tr.hide(100);
          $('#all_meeting_sras').append($(data));
        })
    })

  });
</script>
