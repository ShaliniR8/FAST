<% events.each do |event| %>
  <tr data-id="<%=event.id%>">
    <%@report_headers.each do |h|%>
      <%formatting = h[:title] == 'Attachments' ? 'attachments' : ''%>
      <td class="<%=formatting%> width-cap <%=h[:html_class].present? ? event.send(h[:html_class]) : ''%>">
        <% if h[:field] == 'get_minutes_agenda' %>
          <%= event.get_minutes_agenda(meeting) %>
        <% else %>
          <%=render "forms/show_field", :record => event, :field_hash => h%>
        <% end %>
      </td>
    <%end%>
    <td>
      <!-- View Narrative -->
      <%=link_to "<i class='glyphicon glyphicon-file'></i>".html_safe,
        '#',
        :class => "btn btn-info mb5 view_narrative_btn",
        "data-toggle" => "modal",
        "data-target" => ".bs-example-modal-lg",
        'hover' => 'tooltip',
        title: 'View Narative',
        :route => show_narrative_report_path(event, :meeting => meeting.id)%>
      <!-- View Report -->
      <%=link_to "<i class='fa fa-link'></i>".html_safe,
        report_path(event),
        target: :_blank,
        'hover' => 'tooltip',
        title: 'View Event',
        :class => "btn btn-info mb5"%>
      <%if meeting.has_user(current_user) || meeting.host.users_id == current_user.id%>
        <%if meeting.status != "Closed"%>
          <%if current_user.has_access('meetings','edit', admin: true)%>
            <%if event.status != "Closed"%>
              <!-- Close Event -->
              <%=link_to "<i class='glyphicon glyphicon-ok-circle'></i>".html_safe, '#',
                :class => 'btn btn-danger close_event_btn mb5',
                'data-toggle' => 'modal',
                'data-target' => '.bs-example-modal-lg',
                'hover' => 'tooltip',
                title: 'Close Event',
                :route => close_report_path(event, :redirect_path => meeting_path(meeting))%>
              <!-- Meeting Minutes -->
              <%=link_to "<i class='glyphicon glyphicon-pencil'></i>".html_safe, "#",
                :class => "btn btn-success minutes_btn mb5",
                "data-toggle" => "modal",
                "data-target" => ".bs-example-modal-lg",
                'hover' => 'tooltip',
                title: 'Add Meeting Minutes',
                :route => new_minutes_report_path(event, :meeting => meeting) %>
            <%end%>
            <!-- Carryover Event -->
            <%=link_to "<i class='glyphicon glyphicon-minus'></i>".html_safe, "#",
              :class=>"btn btn-danger mb5",
              :onclick=>"delete_report(#{event.id}, #{meeting.id},this)",
              'hover' => 'tooltip',
              title: 'Carryover Event'%>
          <%end%>
        <%end%>
        <!-- Add Agenda -->
        <%=link_to "<i class='glyphicon glyphicon-list'></i>".html_safe,"#",
          :class => "btn btn-warning agenda_btn mb5",
          "data-toggle" => "modal",
          "data-target" => ".bs-example-modal-lg",
          'hover' => 'tooltip',
          title: 'View/Add Meeting Agenda',
          :route => get_agenda_report_path(event, :meeting => meeting.id)%>
      <%end%>
    </td>
  </tr>

<%end%>

<script>
  $('[hover="tooltip"]').tooltip();
</script>
