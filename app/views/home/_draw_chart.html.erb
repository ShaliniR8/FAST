<script>
  function drawChart(data, params, chartId, downloadId, rootUrl, type = null) {
    // console.log("drawChart, data=", data);
    var options = {
      legend:'none',
      hAxis: {
        minValue: 0
      },
      height:230,
      colors:['blue'],
      bars: 'horizontal',
      chartArea: { left: 100 }// Required for Material Bar Charts.
    };

    var chart = new google.visualization.BarChart(document.getElementById(chartId));

    google.visualization.events.addListener(chart, 'ready', function () {
      document.getElementById(downloadId).innerHTML = '<a href="' + chart.getImageURI() + '"download><u>Download Chart</u></a>';
    });

    chart.draw(google.visualization.arrayToDataTable(data), options);

    google.visualization.events.addListener(chart, 'select', function() {
      var root_url;
      if (type)
        root_url = rootUrl + "?type=" + type + "&status=";
      else
        root_url = rootUrl + "?status=";
      var selection = chart.getSelection();
      var dateParams = params && params.startDate && params.endDate ? "&start_date=" + params.startDate + "&end_date=" + params.endDate : "";
      var empGroupParams = params && params.employeeGroups ? "&" + $.param({emp_groups: params.employeeGroups}) : "";
      var departmentsParams = params && params.departments ? "&" + $.param({departments: params.departments}) : "";
      var row = selection[0].row + 1;
      var status = data[row][0];
      message = root_url + status + dateParams + empGroupParams + departmentsParams;
      window.location=message;
    });
  }
</script>
