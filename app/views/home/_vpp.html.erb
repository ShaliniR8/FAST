<div class="col-xs-12 col-sm-3">
	<div class="panel panel-success">
		<div class="panel-heading">
			<div class="panel-title">
				<b>VP/Part 5 IM Package Statistics</b> 
			</div>
		</div>
		<div class="panel-body" style="height:300px">
						<div class="row">
				<div class="col-xs-12">
					<h5>Average Days to Complete: <%=VpImPackage.get_avg_complete%></h5>
				</div>
			</div>
			<div id="vpp" style="width: 100%"></div>   
			<div id="vpp_download" style="width: 100%" align="right"></div> 
		</div>
	</div>
</div>
<script type="text/javascript">
	<%= render partial: "analytics_data.js.erb", locals: {type: :vpp} %>
	google.charts.load('current', {packages: ['corechart', 'bar']});
	google.charts.setOnLoadCallback(function() {drawChartvpp(vppData);});
	function drawChartvpp(data) {

		var vpp_options = {
			chart: {title: 'SMS IM Statistics'},
			legend:'none',          
			height:230,
			colors:['blue'],
			bars: 'horizontal',
			chartArea: {left:100} // Required for Material Bar Charts.
		};

		var vpp_chart = new google.visualization.BarChart(document.getElementById('vpp'));
		google.visualization.events.addListener(vpp_chart, 'onmouseover', cursor_pointer);
		google.visualization.events.addListener(vpp_chart, 'onmouseout', cursor_default);
		google.visualization.events.addListener(vpp_chart, 'ready', function () {
			document.getElementById('vpp_download').innerHTML = '<a href="' + vpp_chart.getImageURI() + '"download><u>Download Chart</u></a>';
		});
		vpp_chart.draw(google.visualization.arrayToDataTable(data), vpp_options);  
		google.visualization.events.addListener(vpp_chart, 'select', function(){
			var all_status=<%=raw @vpp.keys%>
			var root_url="<%=packages_path%>?type=VpImPackage&status="
			var selection = vpp_chart.getSelection();
			var message = "";
			for (var i = 0; i < selection.length; i++) {
				var item = selection[i];
				message= root_url+all_status[item.row];
			}
			window.location=message;
		});
	}


	$(window).bind('resizeEnd', function() {
		drawChartvpp(vppData);
	});
</script>