<div class="col-xs-12 col-sm-4">
	<div class="panel panel-black">
		<div class="panel-heading">
			<div class="panel-title">
				<b>Framework IM Statistics</b> 
			</div>
		</div>
		<div class="panel-body" style="height:300px">
			<div class="row">
				<div class="col-xs-12">
					<h5>Average Days to Complete: <%=FrameworkIm.get_avg_complete%></h5>
				</div>
			</div>
			<div id="frameworks" style="width: 100%"></div>   
			<div id="frameworks_download" style="width: 100%" align="right"></div> 
		</div>
	</div>
</div>
<script type="text/javascript">
	<%= render partial: "analytics_data.js.erb", locals: {type: :framework} %>
	google.charts.load('current', {packages: ['corechart', 'bar']});
	google.charts.setOnLoadCallback(function() {drawChartframework(frameworkData);});
	function drawChartframework(data) {
		var framework_options = {
			chart: {title: 'SMS IM Statistics'},
			legend:'none',          
			height:230,
			colors:['blue'],
			bars: 'horizont00al',
			chartArea: {left:100} // Required for Material Bar Charts.
		};

		var framework_chart = new google.visualization.BarChart(document.getElementById('frameworks'));
		google.visualization.events.addListener(framework_chart, 'onmouseover', cursor_pointer);
		google.visualization.events.addListener(framework_chart, 'onmouseout', cursor_default);
		
		google.visualization.events.addListener(framework_chart, 'ready', function () {
			document.getElementById('frameworks_download').innerHTML = '<a href="' + framework_chart.getImageURI() + '"download><u>Download Chart</u></a>';
		});
		framework_chart.draw(google.visualization.arrayToDataTable(data), framework_options);  
		google.visualization.events.addListener(framework_chart, 'select', function(){
			var all_status=<%=raw @frameworks.keys%>
			var root_url="<%=ims_path%>?type=FrameworkIm&status="
			var selection = framework_chart.getSelection();
			var message = "";
			for (var i = 0; i < selection.length; i++) {
				var item = selection[i];
				message= root_url+all_status[item.row];
			}
			window.location=message;
		});
	}

	$(window).bind('resizeEnd', function() {
		drawChart(frameworkData, null, "frameworks", "frameworks_download", "<%= ims_path %>", "FrameworkIm");
	});
</script>