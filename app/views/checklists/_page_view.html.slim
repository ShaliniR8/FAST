table.table.table-bordered.table-striped.mt10 id="page-view-#{checklist.id}"
  thead
    tr
      th Page View
      th Attachments
      th Findings
  tbody
    - @contents.each_with_index do |content, index|
      tr
        - checklist_row = checklist.checklist_rows.order(:id)[index]
        - display_content = ''
        - @headers.each do |header|
          - if content[header.id].present?
            - if header.data_type == 'checkboxes'
              - input = content[header.id].gsub(/\;/, "\n")
            - else
              - input = content[header.id]
            - display_content +=  '<strong>' + header.title + '</strong>' + ':<br/>' + input +'<br><br>'
        td
          = display_content.gsub(/\n/, '<br/>').html_safe rescue ''
        td
          - if checklist_row.present?
            = render 'forms/attachments_show_mini', owner: checklist_row
        td
          - if checklist_row.present?
            - if @owner.status != 'Completed'
              = link_to '',
                new_finding_path( owner_id: checklist_row.id, owner_type: checklist_row.class.name ),
                class: 'btn btn-success pull-right mr5 mb5 glyphicon glyphicon-plus new_finding_btn',
                id: checklist_row.id,
                "data-toggle"=>"tooltip", "data-placement"=>"top", "title"=>"Add Finding"
            = link_to '',
              '#',
              class: 'btn btn-info pull-right mr5 mb5 glyphicon glyphicon-list show_finding_btn',
              id: checklist_row.id,
              "data-toggle"=>"tooltip", "data-placement"=>"top", "title"=>"Show Findings",
              "data-toggle"=>"modal","data-target"=>".bs-example-modal-lg"

javascript:
  $('.show_finding_btn').on('click',function(){
    $.get("#{show_finding_audit_path}?checklist_row_id="+$(this).attr("id"), function(data){
      $(".modal-content").html(data);
      $(window).trigger('resize');
    });
  });

  $('.new_finding_btn').on('click',function(){
    $.get("#{new_finding_path(@record)}?owner_id="+$(this).attr("id")+"&owner_type=ChecklistRow&modal=true", function(data){
      $(".modal-content").html(data);
      $(window).trigger('resize');
    });
  });

  $(function(){
    $("#page-view-#{checklist.id}").DataTable({
      "aaSorting": [],
      "aLengthMenu": [[1, -1], [1, "All"]],
      "iDisplayLength": 1,
    })
  });
